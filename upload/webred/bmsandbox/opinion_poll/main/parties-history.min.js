var svg=$('<svg xmlns="http://www.w3.org/2000/svg" version="1.1"></svg>');var timeline=$('<svg xmlns="http://www.w3.org/2000/svg" version="1.1"></svg>');var partyData=[];var electionData=[];var dotGroupsArray=[];var xmls=[];var timelineData=[];var timelineGrid=0;var pollsNum=0;var maxProcent=0;var maxMandate=0;var months=[];months[1]="januar";months[2]="febuar";months[3]="marts";months[4]="april";months[5]="maj";months[6]="juni";months[7]="juli";months[8]="august";months[9]="september";months[10]="oktober";months[11]="november";months[12]="december";$.ajax({type:"GET",url:"../valgresultater.xml",dataType:"xml",success:function(a){$(a).find("datetime").each(function(){electionData[$(this).text().substr(0,4)]=$(this).text().substr(0,10)})}});$.ajax({type:"GET",url:"../parties.xml",dataType:"xml",success:function(b){var a="";var c="";$(b).find("party").each(function(){var d=parseFloat($(this).find("id").text());partyData[d]=[];partyData[d].id=$(this).find("id").text();partyData[d].color=$(this).find("color").text();partyData[d].letter=$(this).find("letter").text();partyData[d].shortname=$(this).find("shortname").text();partyData[d].x=17;partyData[d].timelineX=12;partyData[d].group=0;partyData[d].timelineLine="";partyData[d].procentLine="";partyData[d].mandateLine="";a+='<path party-id="'+d+'" class="parties procent" stroke="'+partyData[d].color+'" fill="none"/>';c+='<path party-id="'+d+'" class="parties mandates" stroke="'+partyData[d].color+'" fill="none"/>'});svg.append('<g id="chart-lines">'+a+c+'</g><g id="chart-dots"/><g id="chart-markers"/>');timeline.append('<g id="timeline-lines">'+a+'</g><g id="timeline-markers"/>');setTimeout("installation();",2)}});var installation=function(){var a=partyData.slice();a.sort(function(e,d){var g=e.letter;var f=d.letter;return(g<f?-1:(g>f?+1:0))});for(var b=a.length-1;b--;){$("#party-toggles").prepend('<p class="party letter '+a[b].letter+'" party-id="'+a[b].id+'" style="background-color:'+a[b].color+'">'+a[b].letter+"</p>");$("#party-toggles ."+a[b].letter).click({id:a[b].id,letter:a[b].letter},function(e){var d="mandates";if($("#mandates-toggle").hasClass("active")){d="procent"}$(this).toggleClass("inactive");$('#chart path[party-id="'+e.data.id+'"]:not(.'+d+'), #timeline path[party-id="'+e.data.id+'"]').toggle();$("#chart ."+e.data.letter+", #timeline ."+e.data.letter).toggle()})}$("#party-toggles .info").show();var c=new Date().getFullYear();for(var b=c;b>=2010;b--){$.ajax({type:"GET",url:"../"+b+"/pollofpolls.xml",dataType:"xml",async:false,success:function(d){$.merge(xmls,$(d))}});if(b==2010){makeTimeline(xmls)}}addEvents()};var makeTimeline=function(f){var e=$(f).find("poll");var g=e.length;var D=35;var r=$("datetime",e[g-1]).text().substr(0,10);var A=$("datetime",e[0]).text().substr(0,10);var q=r;var d=917/(dateDifference(r,A));var u=0;var x="";var l;var C;var n=0;var c=0;var w;timelineGrid=d;for(var v=g;v--;){var j=e[v];var h=$("datetime",j).text().substr(0,10);if(v!==0){var k=$("datetime",e[v-1]).text().substr(0,10)}else{var k=h}var z=parseFloat(h.substr(0,4));var B=$("entry",j);var y=B.length;w=dateDifference(h,k);for(var E=n;E<=(n+w);E++){timelineData[E]=[];timelineData[E].counter=c;timelineData[E].date=h}for(var s=y;s--;){var m=B[s];C=$("id",m).text();var t=parseFloat($("percent",m).text());var b=parseFloat($("mandates",m).text());var p=(t/100)*D;p=(D-p)-p;p=p+10;partyData[C].timelineX=partyData[C].timelineX+(d*dateDifference(q,h));if(z!=u){l=partyData[C].timelineX-(dateDifference(z+"-01-01",h)*d);if(l<0){l=12}x+='<g class="year-marker">';x+='<text x="'+l+'" y="10" fill="#D2D2D2" font-size="11" text-anchor="middle">'+z+"</text>";x+='<line x1="'+l+'" y1="12" x2="'+l+'" y2="17" fill="none" stroke="#D2D2D2" stroke-width="1"/>';x+="</g>";u=z}if(partyData[C].timelineLine===""){partyData[C].timelineLine="M 0 "+p;partyData[C].timelineLine+=" L "+partyData[C].timelineX+" "+p}else{partyData[C].timelineLine+=" L "+partyData[C].timelineX+" "+p;if(v===0){partyData[C].timelineLine+=" L 940 "+p}}if(t>maxProcent){maxProcent=t}if(b>maxMandate){maxMandate=b}}if(w===0){w=1}n=n+w;c++;q=h}$("#timeline-markers",timeline).append(x);$(".parties",timeline).each(function(){var a=$(this).attr("party-id");$(this).attr("d",partyData[a].timelineLine);$(this).attr("stroke-width",1.5)});$("#timeline").append(timeline).html($("#timeline").html());$("#zoomer, #timeline .info").show();makeSVG(f)};var makeSVG=function(G,M,n){var j=$(G).find("poll");var k;var ap;var F;var ae;var z;var B;var A=0;var e=0;var ad=0;var w=17;var O=0;var an="";var J=0;var P="";var ac;var K;var E;var V;var ao;var aj;var W;if(n===undefined){n=j.length-1;pollsNum=n;M=0;ae=0;z=n;F=1}else{$(".parties",svg).each(function(){var i=$(this).attr("party-id");partyData[i].procentLine="";partyData[i].x=17});$("#chart-dots g",svg).remove();$("#chart-markers g",svg).remove();ae=dotGroupsArray.length;z=ae+(n-M);$("#chart svg, #chart .lines").remove()}var L=$("datetime",j[n]).text().substr(0,10);var x=$("datetime",j[M]).text().substr(0,10);var g=L;k=905/(dateDifference(L,x));dotGroupsArray=[];dotGroupsArray.length=0;for(var al=n;al>=M;al--){var b=j[al];ap=$("datetime",b).text().substr(0,10);var t=parseFloat(ap.substr(0,4));var s=ap.substr(5,2);var u=$("respondents",b).text();var h=$("entry",b);var c=h.length;var T=h.sort(function(o,i){var ar=$(i).find("party").find("letter").text();var aq=$(o).find("party").find("letter").text();return(ar<aq?-1:(ar>aq?+1:0))});for(var ab=c;ab--;){var I=T[ab];var ai=$("id",I).text();var Y=parseFloat($("percent",I).text());var f=parseFloat($("mandates",I).text());var N=$("uncertainty",I).text();var H=$("supports",I).text();var d=partyData[ai].shortname;var D="";var am=partyData[ai].group;var p=(Y/parseInt(maxProcent,10))*245;p=245-(p-20);var X=(f/parseInt(maxMandate,10))*245;X=245-(X-20);partyData[ai].x=partyData[ai].x+(k*dateDifference(g,ap));if(!dotGroupsArray[am]){dotGroupsArray[am]=[];dotGroupsArray[am].x=partyData[ai].x;dotGroupsArray[am].procentDots="";dotGroupsArray[am].mandatesDots="";dotGroupsArray[am].date=ap;dotGroupsArray[am].respondents=u;dotGroupsArray[am].supportOneProcent=0;dotGroupsArray[am].supportTwoProcent=0;dotGroupsArray[am].supportOneMandates=0;dotGroupsArray[am].supportTwoMandates=0;dotGroupsArray[am].supportOnePartys="";dotGroupsArray[am].supportTwoPartys="";dotGroupsArray[am].supportOneColor="blue"}if(t!=A){if(electionData[t]!==undefined){w=partyData[ai].x-(dateDifference(electionData[t],ap)*k);an+='<g class="election-marker">';an+='<line class="indicator" x1="'+w+'" y1="20" x2="'+w+'" y2="300" stroke="#76C276" stroke-width="0.3" />';an+='<text x="'+w+'" y="14" fill="#76C276" font-size="11" text-anchor="middle">Valget '+t+"</text>";an+="</g>"}w=partyData[ai].x-(dateDifference(t+"-01-01",ap)*k);if(w>0){an+='<g class="year-marker">';an+='<text x="'+w+'" y="290" fill="#D2D2D2" font-size="12" text-anchor="middle">'+t+"</text>";an+='<g class="marker-arrow">';an+='<line x1="'+(w+16)+'" y1="286" x2="'+(w+22)+'" y2="286" fill="none" stroke="#D2D2D2" stroke-width="2"/>';an+='<path d="M '+(w+22)+" 282 L "+(w+28)+" 286 L "+(w+22)+' 290" fill="#D2D2D2" stroke="#D2D2D2" stroke-width="1"/>';an+="</g>";an+="</g>";e++}A=t}if(s!=ad){w=partyData[ai].x-(dateDifference(t+"-"+s+"-01",ap)*k);if((w-O)>J&&w>9){an+='<g class="month-marker">';an+='<text x="'+w+'" y="312" fill="#D2D2D2" font-size="11" text-anchor="middle">'+months[parseInt(s,10)].substr(0,3)+".</text>";an+='<line x1="'+w+'" y1="300" x2="'+w+'" y2="293" fill="none" stroke="#D2D2D2" stroke-width="1"/>';an+="</g>";O=w}ad=s;J=19}if(partyData[ai].procentLine===""){partyData[ai].procentLine="M "+partyData[ai].x+" "+p;partyData[ai].mandateLine="M "+partyData[ai].x+" "+X}else{partyData[ai].procentLine+=" L "+partyData[ai].x+" "+p;partyData[ai].mandateLine+=" L "+partyData[ai].x+" "+X}if($("#party-toggles ."+partyData[ai].letter).hasClass("inactive")){D=' style="display:none;"'}dotGroupsArray[am].procentDots+='<circle class ="'+partyData[ai].letter+' procent" cx="'+partyData[ai].x+'" cy="'+p+'" r="6" fill="transparent" stroke="'+partyData[ai].color+'" stroke-width="0" date="'+ap+'" procent="'+Y+'" mandates="'+f+'" uncertainty="'+N+'" party-id="'+ai+'" '+D+"/>";dotGroupsArray[am].mandatesDots+='<circle class ="'+partyData[ai].letter+' mandates" cx="'+partyData[ai].x+'" cy="'+X+'" r="6" fill="transparent" stroke="'+partyData[ai].color+'" stroke-width="0" party-id="'+ai+'" '+D+"/>";if(H==1||H==9){dotGroupsArray[am].supportOneProcent+=Y;dotGroupsArray[am].supportOneMandates+=f;dotGroupsArray[am].supportOnePartys+=d+", ";if(partyData[ai].letter=="A"){dotGroupsArray[am].supportOneColor="red"}}else{if(H==2){dotGroupsArray[am].supportTwoProcent+=Y;dotGroupsArray[am].supportTwoMandates+=f;dotGroupsArray[am].supportTwoPartys+=d+", "}}partyData[ai].group++}g=ap}if(e===0){an+='<g class="year-marker">';an+='<text x="17" y="290" fill="#D2D2D2" font-size="12" text-anchor="middle">'+t+"</text>";an+='<g class="marker-arrow">';an+='<line x1="33" y1="286" x2="39" y2="286" fill="none" stroke="#D2D2D2" stroke-width="2"/>';an+='<path d="M 39 282 L 45 286 L 39 290" fill="#D2D2D2" stroke="#D2D2D2" stroke-width="1"/>';an+="</g>";an+="</g>";e++}$("#chart-markers",svg).append(an);if(e===1){$(".marker-arrow",svg).show()}var m=0;var C=0;var Z=maxProcent/6;var l=maxMandate/6;var v="";for(var al=0;al<7;al++){v='<span class="lines"><p altValue="'+C+'">'+parseInt(m,10)+"</p></span>"+v;m=m+Z;C=C+l}$("#chart").append(v);$("#chart .lines:first").addClass("top");if($("#mandates-toggle").hasClass("active")){$("#chart-lines .procent",svg).hide();$("#chart-lines .mandates",svg).show()}else{$("#chart-lines .procent",svg).show();$("#chart-lines .mandates",svg).hide()}$("#chart-lines .parties",svg).each(function(){var i=$(this).attr("party-id");if($(this).hasClass("procent")){$(this).attr("d",partyData[i].procentLine)}else{$(this).attr("d",partyData[i].mandateLine)}$(this).attr("stroke-width",4);if($("#party-toggles ."+partyData[i].letter).hasClass("inactive")){$(this).hide()}});var Q;var U;var aa;for(var al=ae;al<=z;al++){P+='<g date="'+dotGroupsArray[al].date+'" respondents="'+dotGroupsArray[al].respondents+'"';P+=' supportOneProcent="'+dotGroupsArray[al].supportOneProcent+'"';P+=' supportTwoProcent="'+dotGroupsArray[al].supportTwoProcent+'"';P+=' supportOneMandates="'+dotGroupsArray[al].supportOneMandates+'"';P+=' supportTwoMandates="'+dotGroupsArray[al].supportTwoMandates+'"';P+=' supportOnePartys="'+dotGroupsArray[al].supportOnePartys+'"';P+=' supportTwoPartys="'+dotGroupsArray[al].supportTwoPartys+'"';P+=' supportOneColor="'+dotGroupsArray[al].supportOneColor+'"';P+=">";P+='<line class="guide" x1="'+dotGroupsArray[al].x+'" y1="20" x2="'+dotGroupsArray[al].x+'" y2="300" stroke="#bdbec0" stroke-width="0.3" visibility="hidden"/>';P+=dotGroupsArray[al].procentDots;P+=dotGroupsArray[al].mandatesDots;if(al===ae){Q=dotGroupsArray[al].x-5}else{Q=dotGroupsArray[al].x-((dotGroupsArray[al].x-dotGroupsArray[al-1].x)/2)}if(al===z){aa=dotGroupsArray[al].x}else{U=dotGroupsArray[al].x+((dotGroupsArray[al+1].x-dotGroupsArray[al].x)/2);aa=U-Q}P+='<rect class="overlay" x="'+Q+'" y="20" width="'+aa+'" height="245" fill="transparent"/>';P+="</g>";if(al==z){ac=dotGroupsArray[al].supportOneProcent;K=dotGroupsArray[al].supportTwoProcent;E=dotGroupsArray[al].supportOneMandates;V=dotGroupsArray[al].supportTwoMandates;ao=dotGroupsArray[al].supportOneColor;aj=dotGroupsArray[al].supportOnePartys;W=dotGroupsArray[al].supportTwoPartys;ap=dotGroupsArray[al].date.split("-");B="Berlingske Barometer "+parseFloat(ap[2])+". "+months[parseFloat(ap[1])]+" "+ap[0]}}$("#chart-dots",svg).append(P);var R=ac.toFixed(1).toString().replace(".",",")+"%";var a=K.toFixed(1).toString().replace(".",",")+"%";var y=E;var S=V;var r=$("#blockview-first-bottom .blue");var ah=$("#blockview-first-bottom .red");var ak=100-(ac+K);if(ak>0){ac=ac+ak}else{if(ak<0){ac=ak+ac}}if(F!==undefined){r=$("#blockview-first-bottom .blue, #blockview-top .blue");ah=$("#blockview-first-bottom .red, #blockview-top .red")}$("#blockview-first-bottom .red .info").html(B).show();$("#blockview-top, #blockview-first-bottom").show();if(ao=="red"){ah.animate({width:ac+"%"},700);$(".procent",ah).attr("altValue",y).html(R);$("#blockview-first-bottom .red .partys").html(aj.substr(0,aj.length-2));r.animate({width:K+"%"},700);$(".procent",r).attr("altValue",S).html(a);$("#blockview-first-bottom .blue .partys").html(W.substr(0,W.length-2))}else{ah.animate({width:K+"%"},700);$(".procent",ah).attr("altValue",S).html(a);$("#blockview-first-bottom .red .partys").html(W.substr(0,W.length-2));r.animate({width:ac+"%"},700);$(".procent",r).attr("altValue",y).html(R);$("#blockview-first-bottom .blue .partys").html(aj.substr(0,aj.length-2))}$("#chart").append(svg).html($("#chart").html());$("#loader").fadeOut(900);if(("ontouchstart" in window)===true){var ag;var q;var af=[];$("#chart").bind("touchmove touchstart",function(i){i.preventDefault();$.map(af,function(aq,o){removeDotEvent(aq)+o});af=[];ag=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];q=$(document.elementFromPoint(ag.pageX,ag.pageY)).parent();af.push($(q));addDotEvent(q)})}else{$("#chart").bind("mousemove",function(i){$("#tooltip").offset({top:i.pageY+10})});$("#chart-dots g").mouseover(function(){addDotEvent($(this))}).mouseleave(function(){removeDotEvent($(this))})}};var addEvents=function(){$("#toggles").click(function(){$("#blockview-first-bottom div, #blockview-top div").each(function(){var b=$(".procent",this).html();$(".procent",this).html($(".procent",this).attr("altValue"));$(".procent",this).attr("altValue",b)});$(".lines").each(function(){var b=$("p",this).html();$("p",this).html($("p",this).attr("altValue"));$("p",this).attr("altValue",b)});$("#chart-lines .parties").hide();if($("#mandates-toggle").hasClass("active")){$("#party-toggles p").each(function(){if(!$(this).hasClass("inactive")){var b=$(this).attr("party-id");$('#chart-lines path[party-id="'+b+'"].procent').show()}})}else{$("#party-toggles p").each(function(){if(!$(this).hasClass("inactive")){var b=$(this).attr("party-id");$('#chart-lines path[party-id="'+b+'"].mandates').show()}})}$("#toggles p").toggleClass("active")});var a=timelineGrid*60;$("#zoomer .left").draggable({axis:"x",containment:"#zoomer",grid:[timelineGrid,0],drag:function(d,e){var b=e.position.left;var f=$("#zoomer .right").position();if((b+a)>f.left){e.position.left=f.left-a;b=e.position.left}var c=(f.left-b)+10;$("#zoomer .bottom").css({left:b,width:c});$("#zoomer .left-overlay").css("width",b);timelineTooltip();$("p",this).show();$("#timeline-markers").show()}});$("#zoomer .right").draggable({axis:"x",containment:"#zoomer",grid:[timelineGrid,0],drag:function(e,f){var c=$("#zoomer .left").position();var g=f.position.left;if((g-a)<c.left){f.position.left=c.left+a;g=f.position.left}var d=(g-c.left)+10;var b=(940-g)-12;$("#zoomer .bottom").css({left:c.left,width:d});$("#zoomer .right-overlay").css("width",b);timelineTooltip();$("p",this).show();$("#timeline-markers").show()}});$("#zoomer .bottom").draggable({axis:"x",containment:"#zoomer",snap:".marker",drag:function(f,g){var b=g.position;var e=$(this).width();var d=(b.left+e)-11;var c=(940-d)-12;$("#zoomer .left").css("left",b.left);$("#zoomer .right").css("left",d);$("#zoomer .left-overlay").css("width",b.left);$("#zoomer .right-overlay").css("width",c);timelineTooltip();$("#zoomer .left p, #zoomer .right p").show();$("#timeline-markers").show()}});$("#zoomer .left, #zoomer .right, #zoomer .bottom").on("dragstop",function(c,d){var b=timelineTooltip();$("#loader").show();$("#timeline-markers, #zoomer .left p, #zoomer .right p").hide();setTimeout(function(){makeSVG(xmls,b[0],b[1])},1)})};var addDotEvent=function(h){var f=$(h).attr("date").split("-");var e="Berlingske Barometer "+parseFloat(f[2])+". "+months[parseFloat(f[1])]+" "+f[0];var g="";var l=$(h).find("circle.procent").sort(function(o,n){var q=partyData[$(o).attr("party-id")].letter;var p=partyData[$(n).attr("party-id")].letter;return(q<p?-1:(q>p?+1:0))});l.each(function(){if(!$("#party-toggles ."+partyData[$(this).attr("party-id")].letter).hasClass("inactive")){g+='<p class="'+partyData[$(this).attr("party-id")].letter+'">';g+='<span class="color" style="background-color: '+partyData[$(this).attr("party-id")].color+'"></span>';if($("#procent-toggle").hasClass("active")){g+="<strong>"+partyData[$(this).attr("party-id")].shortname+" "+$(this).attr("procent").replace(".",",")+"%</strong>";if($(this).attr("uncertainty")!="0.0"){g+=" (usk. +/- "+$(this).attr("uncertainty").replace(".",",")+")"}}else{g+="<strong>"+partyData[$(this).attr("party-id")].shortname+" "+$(this).attr("mandates").replace(".",",")+"</strong>"}g+="</p>"}});if(parseInt($(h).attr("respondents"),10)!==0){var i=$(h).attr("respondents");if(i.length>3){i=i.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.")}g+="<hr>";g+="<p>Respondenter: "+i+"</p>"}$("#tooltip").show();$("#tooltip header").html(e);$("#tooltip div").html(g);$("#tooltip div").width($("#tooltip header").width()-2);var j="procent";if($("#mandates-toggle").hasClass("active")){j="mandates"}$(h).find("circle."+j).attr({fill:"#ffffff","stroke-width":"2"});$(h).find(".guide").attr("visibility","visible");supportOneProcent=parseFloat($(h).attr("supportOneProcent"));supportTwoProcent=parseFloat($(h).attr("supportTwoProcent"));supportOneMandates=$(h).attr("supportOneMandates");supportTwoMandates=$(h).attr("supportTwoMandates");supportOneColor=$(h).attr("supportOneColor");supportOnePartys=$(h).attr("supportOnePartys");supportTwoPartys=$(h).attr("supportTwoPartys");var c=supportOneMandates;var m=supportTwoMandates;var a=supportOneProcent.toFixed(1).toString().replace(".",",")+"%";var k=supportTwoProcent.toFixed(1).toString().replace(".",",")+"%";if($("#procent-toggle").hasClass("active")){c=supportOneProcent.toFixed(1).toString().replace(".",",")+"%";m=supportTwoProcent.toFixed(1).toString().replace(".",",")+"%";a=supportOneMandates;k=supportTwoMandates}var b=100-(supportOneProcent+supportTwoProcent);if(b>0){supportOneProcent=supportOneProcent+b}else{if(b<0){supportOneProcent=b+supportOneProcent}}if(supportOneColor=="red"){$("#blockview-first-bottom .red").width(supportOneProcent+"%");$("#blockview-first-bottom .red .procent").attr("altValue",a).html(c);$("#blockview-first-bottom .red .partys").html(supportOnePartys.substr(0,supportOnePartys.length-2));$("#blockview-first-bottom .blue").width(supportTwoProcent+"%");$("#blockview-first-bottom .blue .procent").attr("altValue",k).html(m);$("#blockview-first-bottom .blue .partys").html(supportTwoPartys.substr(0,supportTwoPartys.length-2))}else{$("#blockview-first-bottom .red").width(supportTwoProcent+"%");$("#blockview-first-bottom .red .procent").attr("altValue",k).html(m);$("#blockview-first-bottom .red .partys").html(supportTwoPartys.substr(0,supportTwoPartys.length-2));$("#blockview-first-bottom .blue").width(supportOneProcent+"%");$("#blockview-first-bottom .blue .procent").attr("altValue",a).html(c);$("#blockview-first-bottom .blue .partys").html(supportOnePartys.substr(0,supportOnePartys.length-2))}$("#blockview-first-bottom .red .info").html(e);var d=$(".guide",h).position();$("#tooltip").offset({left:d.left+45});if((d.left+$("#tooltip header").width())>860){$("#tooltip").offset({left:d.left-($("#tooltip header").width()+30)});$("#tooltip header").addClass("righty")}else{$("#tooltip header").removeClass("righty")}};var removeDotEvent=function(a){$(a).find("circle").attr({fill:"transparent","stroke-width":"0"});$(a).find(".guide").attr("visibility","hidden");$("#tooltip").hide()};var timelineTooltip=function(){var a=$("#zoomer .left p");var h=$("#zoomer .right p");var g=($("#zoomer .left").position()).left;var f=($("#zoomer .right").position()).left;var b=parseInt(g/timelineGrid,10);var e=parseInt((f-10)/timelineGrid,10);if(b>timelineData.length-1){b=timelineData.length-1}else{if(b<0){b=0}}if(e>timelineData.length-1){e=timelineData.length-1}else{if(e<0){e=0}}var c=timelineData[b].date.split("-");var j=timelineData[e].date.split("-");var d=(a.width()/2);var i=(h.width()/2);if((g+d)<50){d=-d-((g+d)-50)}else{d=-(d-2)}if((f+i)>930){i=-i-((f+i)-930)}else{i=-(i-2)}a.text(parseFloat(c[2])+". "+months[parseFloat(c[1])]).css("left",d);h.text(parseFloat(j[2])+". "+months[parseFloat(j[1])]).css("left",i);e=pollsNum-timelineData[e].counter;b=pollsNum-timelineData[b].counter;return[e,b]};var dateDifference=function(e,d){var a=new Date(e);var b=new Date(d);var c=((b-a)/(1000*60*60*24));return c};